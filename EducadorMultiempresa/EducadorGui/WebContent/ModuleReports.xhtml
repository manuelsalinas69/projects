<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j" template="layout/template.xhtml">

	<ui:define name="body">
		<s:decorate template="/layout/title.xhtml">
			<ui:define name="label">
				#{messages.ConsultasPorModulo_menu}
			</ui:define>
		</s:decorate>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jquery.jqplot.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.barRenderer.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.pieRenderer.min.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.categoryAxisRenderer.min.js"></script>

		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.canvasTextRenderer.min.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.canvasAxisTickRenderer.min.js"></script>

		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.dateAxisRenderer.min.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.pointLabels.min.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/utils/jplotUtil.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/jplot/jqplot.cursor.min.js"></script>
		<link rel="stylesheet" type="text/css"
			href="#{facesContext.externalContext.requestContextPath}/styles/jplot/jquery.jqplot.css" />


		<h:form>
			<rich:panel id="pnlMain" style="border:0px;">
				<h:selectOneMenu value="#{moduleReporManager.idModulo}">
					<f:selectItems value="#{modulosSelectItems}" />
					<a:ajax event="change" execute="@this" render="pnlMain"
						oncomplete="reloadData();" />
				</h:selectOneMenu>
				<a:jsFunction name="reloadData"
					action="#{moduleReporManager.loadPreguntasByModulo()}"
					render="pnlMain" />
				<rich:tabPanel switchType="client">




					<rich:tab header="Ejecuciones">
						<a:commandButton action="#{moduleReporManager.reportTest()}"
							execute="@this" data="#{moduleReporManager.resumenEjecucion}"
							oncomplete="plotBarReport('#resumenEjecucion','Resumen Ejecuciones',event.data);"
							value="Resumen" />
						<a:commandButton action="#{moduleReporManager.reportCancelados()}"
							execute="@this" data="#{moduleReporManager.resumenCancelados}"
							oncomplete="plotBarReport('#resumenCancelados','Resumen Cancelados',event.data);"
							value="Cancelados" />
						<rich:panel styleClass="tabContent" style="border:0px">

							<table>
								<tr>
									<td>
										<div id="resumenEjecucion" class="jqplot-target" />
									</td>
									<td>
										<div id="resumenCancelados" class="jqplot-target" />
									</td>
								</tr>

							</table>
						</rich:panel>
					</rich:tab>
					<rich:tab header="Comportamiento de env&iacute;o de respuestas">
						<a:commandButton
							action="#{moduleReporManager.reportFechaRespuestas()}"
							execute="@this"
							data="#{moduleReporManager.resumenfechaRespuestas}"
							oncomplete="plotDateReport('#resumenRespuestas','Fechas Respuestas',event.data);"
							value="Respuestas" />
						<rich:panel styleClass="tabContent"  style="border:0px">
							<table width="100%">
								<tr>
									<td width="100%">
										<div id="resumenRespuestas" class="jqplot-target" />
									</td>
								</tr>
							</table>
						</rich:panel>
					</rich:tab>
					<rich:tab header="Tips">
						<h:panelGrid columns="2">
							<a:commandButton value="Ver enviados"
								action="#{moduleReporManager.reportTipEviados()}"
								render="pnlTips" data="#{moduleReporManager.jsonData}"
								execute="@this"
								oncomplete="plotBarLegendReport('#tipReportes','Enviados',event.data);" />
							<a:commandButton value="Ver fallidos"
								action="#{moduleReporManager.reportTipFallidos()}"
								render="pnlTips" data="#{moduleReporManager.jsonData}"
								execute="@this"
								oncomplete="plotBarLegendReport('#tipReportesFallidos','Fallidos',event.data);" />
						</h:panelGrid>
						<rich:panel styleClass="tabContent" style="border:0px">
							<table>
								<tr>
									<td valign="middle" colspan="3"><a:outputPanel
											id="pnlTips">
											<rich:dataTable value="#{moduleReporManager.tips}" var="_det"
												rowKeyVar="_index">
												<rich:column>
													<h:outputText value="#{_index+1}" />

												</rich:column>
												<rich:column>
													<h:outputText value="#{_det.contenido}" />
												</rich:column>
												<rich:column>
													<a:commandLink value="Ver fallidos"
														action="#{moduleReporManager.reporteFallidoPorTip(_det.idTip)}"
														execute="@this" data="#{moduleReporManager.jsonData}"
														oncomplete="plotBarReport('#tipFallidosPorTip','Resumen Fallidos',event.data);" />
												</rich:column>
											</rich:dataTable>
										</a:outputPanel></td>
								</tr>
								<tr>
									<td valign="top">
										<div id="tipReportes" />
									</td>
									<td valign="top">
										<div id="tipReportesFallidos" />
									</td>
									<td valign="top">
										<div id="tipFallidosPorTip" />
									</td>

								</tr>
							</table>
						</rich:panel>
					</rich:tab>
					<rich:tab header="Preguntas">
						<rich:panel styleClass="tabContent">
							<f:facet name="header">
									Preguntas
								</f:facet>

							<h:panelGrid columns="4" columnClasses="top,top,top,top">

								<rich:dataTable value="#{moduleReporManager.preguntas}"
									var="_det" rowKeyVar="_index">
									<rich:column>
										<f:facet name="header">
											Preguntas
										</f:facet>
										<a:commandLink value="#{_det.contenidoPregunta}"
											onclick="res4(#{_det.idPregunta});res5(#{_det.idPregunta});res1(#{_det.idPregunta}); res2(#{_det.idPregunta}); res3(#{_det.idPregunta});" />
										<a:jsFunction name="res4" execute="@this"
											action="#{moduleReporManager.reportEnvioPregunta()}"
											data="#{moduleReporManager.jsonData}"
											oncomplete="plotBarReport('#resumenPreguntaEnvios','Resumen Envios',event.data);">
											<a:param name="idPregunta"
												assignTo="#{moduleReporManager.idPregunta}" />
										</a:jsFunction>
										
										<a:jsFunction name="res5" execute="@this"
											action="#{moduleReporManager.reporteEnvioFallidoEnvioPregunta()}"
											data="#{moduleReporManager.jsonData}"
											oncomplete="plotBarReport('#resumenPreguntasFallidas','Fallidos',event.data);">
											<a:param name="idPregunta"
												assignTo="#{moduleReporManager.idPregunta}" />
										</a:jsFunction>
										
										<a:jsFunction name="res1" execute="@this"
											action="#{moduleReporManager.reportPregunta()}"
											data="#{moduleReporManager.resumenPregunta}"
											oncomplete="plotBarReport('#resumenPregunta','Resumen General Pregunta',event.data);">
											<a:param name="idPregunta"
												assignTo="#{moduleReporManager.idPregunta}" />
										</a:jsFunction>
										<a:jsFunction name="res2"
											action="#{moduleReporManager.reportPreguntaRespondidas()}"
											execute="@this"
											data="#{moduleReporManager.resumenPreguntasRepondidas}"
											oncomplete="plotBarReport('#resumenPreguntaRespondidaBar','Respondidas',event.data);">
											<a:param name="idPregunta"
												assignTo="#{moduleReporManager.idPregunta}" />
										</a:jsFunction>
										<a:jsFunction name="res3"
											action="#{moduleReporManager.reportPreguntasCorrectas()}"
											data="#{moduleReporManager.jsonData}" execute="@this"
											oncomplete="plotPieReport('#resumenPreguntaRespondidaPie','Porcentaje',event.data);">
											<a:param name="idPregunta"
												assignTo="#{moduleReporManager.idPregunta}" />
										</a:jsFunction>
									</rich:column>

								</rich:dataTable>

								<table>
									<thead align="center">
										Datos de la pregunta seleccionada
									</thead>
									<tr>
										<td>
											<div id="resumenPreguntaEnvios" />
										</td>
										<td>
											<div id="resumenPreguntasFallidas" />
										</td>
									</tr>
									<tr>
										<td colspan="2">
											<div id="resumenPregunta" />
											
										</td>
									</tr>
									<tr>
										<td>
											<div id="resumenPreguntaRespondidaBar" />
										</td>
										<td>
											<div id="resumenPreguntaRespondidaPie" />
										</td>
									</tr>
								</table>



							</h:panelGrid>
						</rich:panel>
					</rich:tab>
					<rich:tab header="Archivos">
						<rich:panel styleClass="tabContent"  style="border:0px">
							<rich:dataTable value="#{moduleReporManager.preguntas}"
									var="_det" rowKeyVar="_index">
									<rich:column>
										<f:facet name="header">
											Preguntas
										</f:facet>
										<h:outputText value="#{_det.contenidoPregunta}" />
									</rich:column>
									<rich:column>
										<f:facet name="header">
											#{messages.msg_list_action_column}
										</f:facet>
										<h:commandButton action="#{moduleReporManager.downloadNumerosPreguntas(_det.evaluacion.idEvaluacion)}" value="Descagar numeros"
											title="Descarga los numeros de los usuarios de Tigo que han respondido a la pregunta seleccionada"
										 />
									</rich:column>
								</rich:dataTable>
						</rich:panel>
					</rich:tab>
					<rich:tab header="Leyendas">
						<rich:panel styleClass="tabContent"  style="border:0px">
							<h:panelGrid>
								<s:div styleClass="infoClass defaultText ">
									
										<h:outputText value="Errores conocidos del SMS (Command Status)" />
										<ui>
											<li><h:outputText value="1005 - Black List" /></li>
											<li><h:outputText value="'11' - El numero se ha portado, se denuncio como robado o el numero no esta en uso (El cliente cambio de numero)" /></li>
											<li><h:outputText value="'8' - El numero tiene un corte administrativo o se encuetra en Roaming y no tiene el servicio activo" /></li>
											
										</ui>
									
								</s:div>
								
							
							</h:panelGrid>
						
						</rich:panel>
					</rich:tab>
				</rich:tabPanel>












			</rich:panel>
		</h:form>
	</ui:define>

</ui:composition>
